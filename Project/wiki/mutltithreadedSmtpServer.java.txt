

1

2

3

4

4
Sure, here is a code to create an SMTP server that allows multithreaded access:

Java
import java.io.IOException;
import java.io.InputStream;
import java.io.PrintWriter;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class SMTPServer {

  private static final int SMTP_PORT = 25;

  private final ExecutorService executorService = Executors.newFixedThreadPool(10);

  public void start() throws IOException {
    ServerSocket serverSocket = new ServerSocket(SMTP_PORT);
    while (true) {
      Socket socket = serverSocket.accept();
      executorService.submit(new SMTPHandler(socket));
    }
  }

  private static class SMTPHandler implements Runnable {

    private final Socket socket;

    public SMTPHandler(Socket socket) {
      this.socket = socket;
    }

    @Override
    public void run() {
      try {
        PrintWriter out = new PrintWriter(socket.getOutputStream(), true);
        InputStream in = socket.getInputStream();

        out.println("220 Welcome");

        String line;
        while ((line = readLine(in)) != null) {
          if (line.equals("QUIT")) {
            break;
          }

          // Process the SMTP command.
        }
      } catch (IOException e) {
        e.printStackTrace();
      } finally {
        try {
          socket.close();
        } catch (IOException e) {
          e.printStackTrace();
        }
      }
    }

    private String readLine(InputStream in) throws IOException {
      String line = "";
      int c;
      while ((c = in.read()) != -1) {
        if (c == '\n') {
          return line;
        }
        line += (char) c;
      }
      return line;
    }
  }

  public static void main(String[] args) throws IOException {
    SMTPServer server = new SMTPServer();
    server.start();
  }
}
Use code with caution. Learn more
This code creates an SMTP server that listens on port 25. The server is multithreaded, so multiple users can connect to the server and send emails simultaneously.

To run the code, you can compile the code and then run the following command:

java SMTPServer
This will start the SMTP server. You can then connect to the server using an SMTP client, such as Thunderbird or Outlook.